<h1>{{title}}</h1>

<div *ngIf="user" class="perfil">
  <h1>{{user.name}}</h1>
  <h3>@{{user.nick}}</h3>
  <p *ngIf="following">Te sigue</p>
  <p>{{user.biography}}</p>
  <hr/>
  <div>
    <button *ngIf="identity._id == user._id" [routerLink]="['/edit-profile']">
      Editar perfil
    </button>
    <div *ngIf="identity._id != user._id && this.follows">
      <button *ngIf="follows.indexOf(user._id) < 0 ;else following"
              (click)="followUser(user._id)">
        Seguir
      </button>
      <ng-template #following>
        <button  (mouseenter)="mouseEnter(user._id)" (mouseleave)="mouseLeave(user._id)"
                 (click)="unfollowUser(user._id)" [class.danger]="followCursor==user._id">
          <span *ngIf="followCursor != user._id ;else unfollow">Siguiendo</span>
          <ng-template #unfollow>Dejar de seguir</ng-template>
        </button>
      </ng-template>
    </div>
  </div>
  <div *ngIf="stats" class="perfil_stats">
    <a [routerLink]="['/following',user._id,1]">Siguiendo: {{stats.following}}</a>
    <a [routerLink]="['/followed',user._id,1]">Seguidores: {{stats.followed}}</a>
    <a>Publicaciones: {{stats.publications}}</a>
  </div>
</div>

<div class="publicationes_usuario">
  <div class="timeline_boton">
    <button (click)="refresh()">Refrescar</button>
  </div>
  <div *ngFor="let publication of publications">
    <div class="publicacion_imagen">
      <img *ngIf="publication.user.image" src="{{url+'/getImage/'+publication.user.image}}"/>
      <img *ngIf="!publication.user.image" src="assets/default/banner_default.jpg"/>
    </div>
    <div class="publicacion_datos">
      <h3>{{publication.user.nick}} | @{{publication.user.name}}</h3>
      <span class="date">
            {{ (publication.created_at) * 1000 | date: 'medium'}}
      </span>
    </div>
    <p>{{publication.text}}</p>
    <button *ngIf="this.identity._id == publication.user._id" (click)="deletePublication(publication._id)">
      Borrar
    </button>
    <hr/>
  </div>
  <div *ngIf="page < pages">
    <button (click)="viewMore()">Ver m√°s publicaciones</button>
  </div>
</div>
